version: 1.0
runtime: nodejs20
build:
  commands:
    build:
      - npm install -g pnpm tsx
      - pnpm install --frozen-lockfile

run:
  runtime-version: 20
  command: cd apps/api && npx tsx src/index.ts
  network:
    port: 3002
    env: APP_PORT
  env:
    # ============================================
    # BACKEND VARIABLES (Required)
    # ============================================
    - name: NODE_ENV
      value: "production"

    - name: PORT
      value: "3002"

    # AI Provider - CHOOSE AT LEAST ONE:
    # Option 1: Anthropic Claude (Recommended - Easiest)
    - name: ANTHROPIC_API_KEY
      value: "REPLACE_WITH_YOUR_ACTUAL_KEY"
      # Get key from: https://console.anthropic.com/

    # Option 2: AWS Bedrock (Uncomment if using)
    # - name: AWS_ACCESS_KEY_ID
    #   value: "AKIA..."
    # - name: AWS_SECRET_ACCESS_KEY
    #   value: "your-secret-key"
    # - name: AWS_REGION
    #   value: "us-east-1"

    # Option 3: OpenAI GPT (Uncomment if using)
    # - name: OPENAI_API_KEY
    #   value: "sk-proj-..."

    # ============================================
    # FRONTEND VARIABLES (Not Needed!)
    # ============================================
    # ✅ VITE_API_URL - NOT NEEDED (same domain)
    # ✅ VITE_FIREBASE_* - NOT NEEDED (has defaults)
    # ✅ ALLOWED_ORIGINS - NOT NEEDED (CORS auto-configured)
